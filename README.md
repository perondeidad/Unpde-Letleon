![logo](images/logo.png)

# Unpde è§£å¯† .PDE æ–‡ä»¶

## æ­¤ä»“åº“ä»…å¯ç”¨äºå­¦ä¹ ç›®çš„ï¼Œä¸å¯ç”¨äºå•†ä¸šç›®çš„ï¼

## è¯´æ˜

FC ç‰ˆæœ¬:1.0.1.9920

æ‰€æœ‰debugåˆ†æå‡æ¥è‡ªæ­¤ç‰ˆæœ¬

ä½¿ç”¨c#ç¼–å†™

## C++ç‰ˆæœ¬ UnPdeC

[UnPdeC](https://letleon.coding.net/public/3d/UnPdeC/git/files)


## æºç ä¸äºŒè¿›åˆ¶æ–‡ä»¶(ä¸ä¸€å®šåŒæ­¥)

[ç™¾åº¦ç½‘ç›˜](https://pan.baidu.com/s/1MkWH6L6bsx3PJQWJuslwKw?pwd=fcfc "ç™¾åº¦ç½‘ç›˜")

[OneDrive](https://1drv.ms/f/s!AhZa6xQIJXNNjUoVv3AFIUxeb-Ck?e=6N12WI "OneDrive")

[123 äº‘ç›˜](https://www.123pan.com/s/b5Y0Vv-rN4J3.html)

#### æµ‹è¯•ç¨‹åº

[Unpde.exe](TestRelease/Unpde.exe)

ä½ å¯èƒ½éœ€è¦.net8 è¿è¡Œæ—¶æ‰èƒ½æ­£å¸¸è¿è¡ŒUnpde

[.NET8 è¿è¡Œæ—¶](https://dotnet.microsoft.com/zh-cn/download/dotnet/8.0)


è¯·ä¸è¦ç”¨äºå•†ä¸šç›®çš„ï¼

#### ç›®å‰çŠ¶æ€ï¼š
.lua .mesh .anim ç­‰æ–‡ä»¶ä¼¼ä¹æ˜¯è‡ªå®šä¹‰æ ¼å¼!

æœ€ç»ˆè§£å¯†å‡½æ•°å­˜åœ¨è¶Šç•Œé—®é¢˜ï¼

å¯ä»¥è‡ªå·±æŸ¥æ‰¾æœªè§£å¯†åŒºåŸŸï¼Œä½†é€Ÿåº¦éå¸¸æ…¢ï¼

### TODO
- [x] å‘ç°å¯ä»¥å°†.cache(æœªäºŒè§£)æ–‡ä»¶éƒ½æ”¾åˆ°finalcombat.pdeç›®å½•ä¸­ï¼Œä¹Ÿèƒ½æ­£å¸¸åŠ è½½ï¼
- [x] å¯¼å‡ºçš„mp3å¬èµ·æ¥æ€ªæ€ªçš„å¯ä»¥ç”¨å·¥å…·å†æ¬¡è½¬ç æˆmp3å³å¯è§£å†³ï¼
- [ ] å‘ç°æœ€ç»ˆè§£å¯†å‡½æ•°å­˜åœ¨è¶Šç•Œé—®é¢˜ï¼
- [x] æœ€ç»ˆè§£å¯†æ–¹æ³•æ·»åŠ äº†6Få’Œ6Dæ ‡å¿—çš„åˆ¤æ–­
- [x] PDEKEYæ”¹ä¸ºä½¿ç”¨å‡½æ•°ç”Ÿæˆ
- [ ] åˆæ­¥å®ŒæˆæŸ¥æ‰¾æœªè§£ç ç›®å½•åŠŸèƒ½ï¼Œéå¸¸æ…¢ï¼ä½†èƒ½å…¨éƒ¨å¯¼å‡ºåˆ°Otherç›®å½•ï¼
- [x] ä¸ºåç§»å€¼æ—¥å¿—(OffsetLog)æ·»åŠ BOffseté”®,è¡¨ç¤ºæ­¤æ•°æ®åœ¨å“ªä¸ªå—ä¸­
- [x] æ·»åŠ è¯¦ç»†çš„æ³¨é‡Š
- [x] ä¸ºåç§»å€¼æ—¥å¿—(OffsetLog)æ·»åŠ OOffseté”®ï¼Œè¡¨ç¤ºåŸå§‹åç§»å€¼
- [x] ä¿®å¤ä¿å­˜è°ƒè¯•ç”¨PDEæ—¶è¶Šç•Œé—®é¢˜
- [x] é™¤äº†FCçš„PDEæ–‡ä»¶ï¼Œè¿˜å¯ä»¥è§£å‹ASçš„PDEæ–‡ä»¶
- [x] å¯ä»¥è§£å‹ç›®å½•ä¸‹ä»»æ„pdeæ–‡ä»¶
- [x] ä¿®æ”¹é€»è¾‘åï¼Œå¯è§£å‹ 1.0.1.9920 å’Œ 1.0.6.7960 ç‰ˆæœ¬çš„ PDE æ•°æ®ï¼Œç†è®ºä¸Šå¯è§£ä»»æ„ç‰ˆæœ¬ PDE æ•°æ®
- [x] ä¼˜åŒ–æœ€ç»ˆè§£å¯†é€»è¾‘ï¼Œåˆ¤æ–­æŸäº›ä¸ç”¨äºŒæ¬¡è§£å¯†çš„æ–‡ä»¶
- [x] ä¼˜åŒ– Offsetlogï¼Œå¯ä»¥ä¿å­˜ä¸ºæ ‘çŠ¶ç»“æ„ï¼Œæ›´ç›´è§‚æŸ¥æ‰¾
- [x] fsb éŸ³ä¹æ–‡ä»¶å¯ä»¥ç”¨ [FSB æå–å™¨ 16.10.21 (aezay.dk)](http://aezay.dk/aezay/fsbextractor/) æ­£ç¡®æ’­æ”¾ï¼Œä¸åœ¨ä½¿ç”¨ [foobar2000](https://www.foobar2000.org/download)
- [x] æ‰¾åˆ°äº†ä¸¤ä¸ªç›®å½•åœ°å€
- [x] ä¸èƒ½äºŒæ¬¡è§£å¯†çš„æ–‡ä»¶ä¼šå.cache åç¼€ï¼Œæ²¡æœ‰.cache åç¼€çš„æ˜¯è¢«äºŒæ¬¡è§£å¯†çš„æ–‡ä»¶ï¼Œæœ‰äº›è™½ç„¶æ²¡æœ‰.cache åç¼€ï¼Œå¯èƒ½ä¼šæœ‰éƒ¨åˆ†æ–‡ä»¶ä¸æ­£å¸¸ã€‚
- [ ] æœ€ç»ˆè§£å¯†é€»è¾‘ï¼Œæœ‰äº›æ–‡ä»¶ä¼šè¶Šç•Œï¼Œæœ‰äº›æ²¡é—®é¢˜ï¼Œè¿˜å¾—è·Ÿ~
- [ ] lua æ–‡ä»¶äºŒæ¬¡è§£å¯†åä¼¼ä¹è¿˜æ˜¯åŠ å¯†çš„ï¼
- [x] åˆæ­¥å®Œæˆè²Œä¼¼æœ€ç»ˆè§£å¯†é€»è¾‘!ğŸ‰
- [x] è·Ÿè¸ªäº†æœ€ç»ˆè§£å¯†é€»è¾‘ï¼Œå‘ç°ç›¸å½“å¤æ‚~æœ‰ç©ºå†ææŠŠï¼
- [x] æ‰¾åˆ°äº†è²Œä¼¼æœ€ç»ˆè§£å¯†çš„é€»è¾‘ï¼ï¼ï¼ğŸ‰
- [x] è§£å¯†åçš„ DDS æ–‡ä»¶ä¸èƒ½æ­£ç¡®æ˜¾ç¤ºï¼æ€€ç–‘ DDS æ–‡ä»¶è¢«ä¿®æ”¹äº†ï¼
- [ ] æœªçŸ¥ 170 ä¸ªå—ä¸çŸ¥æ˜¯å¹²å•¥çš„ï¼
- [x] é”™è¯¯ è§£å¯†åçš„ FSB éŸ³ä¹ä»¥åŠ SWF æ–‡ä»¶æœ‰äº›ä¸å®Œæ•´ï¼
- [ ] æŸäº›ç›®å½• æ¯”å¦‚ 1580 å¤„ï¼Œå†™çš„æ˜¯ 7000 å¤§å° å®é™…åªæœ‰ 1000 å¤§å°ï¼Œå¯¼è‡´è¯»å–çš„æ•°æ®é‡ä¸æ­£å¸¸ï¼è¿˜å¾—è·Ÿ~
- [x] lua ä¼¼ä¹ä¸æ­£ç¡®æˆ–æ˜¯åŠ å¯†çš„ï¼
- [x] ä¸€ä¸ªçŒœæµ‹ï¼Œdds tag lua å¯èƒ½ä¸æ˜¯çœŸæ­£çš„æ–‡ä»¶ï¼Œå¯èƒ½åªæ˜¯ä¸ªæŒ‡é’ˆï¼Ÿ
- [ ] å‘ç°å¾ˆå¤šåç§»å€¼å¹¶ä¸æ˜¯åªè¯»äº†ä¸€æ¬¡ï¼Œè€Œä¸”æœ‰äº›åç§»å€¼çš„æ¯æ¬¡è¯»çš„å¤§å°éƒ½ä¸åŒï¼
- [x] æœªè·Ÿè¸ª è§£å¯†æ—¶å¤§å°è¶…è¿‡ 1000H æ—¶(ä¹Ÿå°±æ˜¯ KEY å¤§å°)ï¼Œå¦‚ä½•ç»§ç»­å¾ªç¯ï¼Ÿå·²è§£å†³ï¼ŒKey å¾ªç¯å°±è¡Œäº†ï¼
- [x] è¯»å–å¤§èµ„æºæ–‡ä»¶æ—¶ï¼Œä¸çŸ¥ä»å“ªé‡ŒæŠ“åˆ°çš„åç§»å€¼ï¼Œæ€€ç–‘æ—¶ 170 è¡¨é‡Œçš„å€¼ï¼
- [x] å·²çŸ¥ è§£å¯† Fun4 æ˜¯è§£ 170 è¡¨
- [x] å·²çŸ¥ è§£å¯† Fun1 / 2 æ˜¯è§£å¯†æ–‡ä»¶/æ–‡ä»¶å¤¹è¡¨
- [x] å·²çŸ¥ è§£å¯† Fun 3 æ˜¯è§£å¯†å®é™…å•ä¸ªæ–‡ä»¶çš„å‡½æ•°
- [x] ç®€å•æ¨¡æ‹Ÿå®ç°äº† Fun 3 æŠ“æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶çš„é€»è¾‘
- [x] ç®€å•å®ç°äº†åˆ©ç”¨ 1000H çš„ç›®å½•æ•°æ®ï¼Œæ‰¹é‡å¯¼å‡ºäº† 1188 ä¸ªæ–‡ä»¶,ä½†æ–‡ä»¶ä¸å®Œæ•´!!!
- [x] å¯ä»¥ä»¥ç›®å½•çš„æ–¹å¼å†™å…¥ç£ç›˜
- [x] å¯ä»¥è¾“å‡ºä¸€ä¸ªè§£å¯†åçš„ HEX ä½œä¸ºè°ƒè¯•æ—¶ä½¿ç”¨
- [x] å¯ä»¥è¾“å‡ºä¸€ä¸ªå…¨éƒ¨åç§»å€¼çš„ JSON ä¾›è°ƒè¯•æ—¶ä½¿ç”¨
- [x] æ·»åŠ äº†æ–‡ä»¶éªŒè¯ç±»ï¼Œåœ¨æ²¡æœ‰æ‰¾åˆ°çœŸæ­£æ–‡ä»¶æ•°æ®ä¹‹å‰å…ˆé¡¶ç€ï¼
- [x] ç›®å‰å¯è§£ 4000 ä¸ªæ–‡ä»¶ï¼Œä½†å¤§å¤šæ•°æˆ‘è®¤ä¸ºä¸æ˜¯çœŸæ­£çš„æ–‡ä»¶
- [x] OffsetLog æ”¹æˆåµŒå¥—ç»“æ„

---

# Build

#### å‡†å¤‡:

ç³»ç»Ÿ windows10/11

å®‰è£… visual studio 2022 (é€‰æ‹© .NET æ¡Œé¢å¼€å‘)

æ‰“å¼€æºç ï¼Œä¹‹åå³é”® ç®¡ç†è§£å†³æ–¹æ¡ˆçš„ NuGet ç¨‹åºåŒ…,ä¸‹è½½ Newtonsoft.Json v13.0.3

#### ç¼–è¯‘:

é¦–å…ˆä½ éœ€è¦å…ˆ build ç¨‹åºï¼Œç„¶åä¼šç”Ÿæˆ Unpde\bin\x86\Debug\net8.0 ç›®å½•

å°† v1.0.1.9920 ç‰ˆæœ¬çš„ finalcombat.pde æ–‡ä»¶

æ”¾ç½®åˆ° Unpde\bin\x86\Debug\net8.0 ç›®å½•ä¸­

åœ¨æ¯” build æˆ– run å³å¯åœ¨ Unpde\bin\x86\Debug\net8.0 ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½• Unpde

è¿™ä¸ªç›®å½•å°±æ˜¯è§£å¯†çš„ç»“æœç›®å½•äº†ï¼

---

# çº¿ç´¢

## Key è·å–

#### æ‰‹åŠ¨è·å–

åœ¨ 00A60950 Xor è§£å¯†å‡½æ•°ä¸­

å¾€ä¸‹ åˆ°è¾¾è¿™ä¸ªå¾ªç¯ï¼Œè§‚å¯Ÿ EDI ï¼ŒEDI çš„ä½ç½®å°±æ˜¯ KEY çš„æ•°æ®ï¼Œ

å¤§å°æ˜¯ 1000Hï¼ˆecxï¼‰

![key](images/key.png)

#### å‡½æ•°ç”Ÿæˆ
åœ¨ 00A608E0 å¤„å¯ä»¥ç”Ÿæˆ KEY

![PdeKeyFun](images/PdeKeyFun.png)

## æœ€ç»ˆè§£å¯†é€»è¾‘

åœ¨ 004CFA90 å‡½æ•°å¤„
å°†åˆæ¬¡è§£ç çš„æ–‡ä»¶æ•°æ® å†æ¬¡å¤„ç†

![D1.png](images/D1.png)

ä»å†…å­˜å¤åˆ¶å¤„æŸä¸ª DDSï¼ŒDDS å¯è¢«æ­£ç¡®è¯†åˆ«å¹¶æ˜¾ç¤º
åƒæ˜¯ä¸ªå¼¹ç—•ï¼

![D4.png](images/D4.png)

## æ–‡ä»¶åç§»å€¼ä¸å¤§å°è·å–æ–¹æ³•

```
æ–‡ä»¶åç§»é‡
  B8690200
  å³ 000269B8 + 1 = 000269B9H
  å³å¯å¾—åˆ°åç§»é‡
  !åœ¨ç»è¿‡è®¡ç®—å³å¯å¾—åˆ°åœ¨PDEä¸­çš„å®é™…åœ°å€

æ–‡ä»¶å¤§å°
  56000000 -> 0x56ï¼Œæ­¤æ–‡ä»¶çš„å¤§å°
```

![offset1](images/offset1.jpg)

## æ–‡ä»¶ä¸æ–‡ä»¶å¤¹çš„æ ‡è¯†ä»¥åŠå—å¤§å°

```
ğŸ—‚ï¸ æ–‡ä»¶å¤¹ 02
ğŸ“„ æ–‡ä»¶ 01
ğŸ“¦ å—å¤§å° 80H -> 128
```

![offset2](images/offset2.jpg)

![offset4](images/offset4.jpg)

---

# äºŒæ¬¡å¾…è§£å¯†æ•°æ®åˆ†æ
### 6F

![6F](images/6F.png "6F")

```
ç´«è‰² -> æ ‡å¿—: 6F
é»„è‰² -> head: 010A0000 02008100
è“è‰²1 & è“è‰²2 -> ä»0X18å¼€å§‹åˆ°ç»“å°¾çš„å¤§å°: 703E4100 -> 0X413E70
çº¢è‰² -> æ–‡ä»¶æ•°é‡ï¼Ÿ: 01000000 -> 0X1
ç»¿è‰² -> è§£ç åå¤§å°: B308BA00 -> 0XBA08B3
å®é™…å‚ä¸è§£ç çš„æ•°æ®:
	ä»0x21å¼€å§‹(ç»¿è‰²ç«–çº¿)åˆ°ç»“å°¾
æœ€ç»ˆæ–‡ä»¶:
	éœ€è¦ç§»é™¤å‰8ä¸ªå­—èŠ‚
```

### 6D

![6D](images/6D.png "6D")

```
ç´«è‰² -> æ ‡å¿—: 6D
é»„è‰² -> head: 00060000 02000300
è“è‰²1 & è“è‰²2 -> ä»0X18å¼€å§‹åˆ°ç»“å°¾çš„å¤§å°: 340000 -> 0X34
çº¢è‰² -> æ–‡ä»¶æ•°é‡ï¼Ÿ: 01000000 -> 0X1
ç»¿è‰² -> è§£ç åå¤§å°: 59 -> 0X59
å®é™…å‚ä¸è§£ç çš„æ•°æ®:
	ä»0x1Bå¼€å§‹(ç»¿è‰²ç«–çº¿)åˆ°ç»“å°¾
æœ€ç»ˆæ–‡ä»¶:
	éœ€è¦ç§»é™¤å‰8ä¸ªå­—èŠ‚ ? æœªéªŒè¯ï¼ï¼ï¼
```

# Heads (åˆæ¬¡è§£ç å)

**Head åˆ†æç»“æœå¦‚ä¸‹**

#### .lua

010A0000 02000100

#### .anim

00050000 02000300

#### .fsb

46534234

#### .tga / .dds

01020000 02000100

#### .dcl

000C0000 02000200

#### .swf

4357530A

#### .ttf

00010000 00120100 00040020 44534947

#### .mesh

00010000 02000800

#### .occ

010A0000 02000100

#### .physx

00070000 02000500

#### .pd9

02040000 02000300

#### .vd9

01040000 02000300

#### .skel

00060000 02000300

#### .spr

000D0000 02000000

#### .vfx

01020000 02000100

---

# é¢„è§ˆ

## ğŸ¸ FSB éŸ³ä¹æ–‡ä»¶æ’­æ”¾å™¨

#### [~~foobar2000~~](https://www.foobar2000.org/download)

~~éœ€è¦ç”¨åˆ°è¿™ä¸ªè€ç‰Œæ’­æ”¾å™¨
[vgmstream decoder](https://www.foobar2000.org/components/view/foo_input_vgmstream)~~

~~ä»¥åŠè¿™ä¸ªæ’ä»¶å³å¯æ’­æ”¾ FSB éŸ³ä¹æ–‡ä»¶
(ä½†ç°åœ¨è§£å‡ºçš„èµ„æºä¸å®Œæ•´ï¼ï¼ï¼)~~

#### [FSB æå–å™¨ 16.10.21 (aezay.dk)](http://aezay.dk/aezay/fsbextractor/)

å¯æ­£ç¡®è¯†åˆ« fsb æ–‡ä»¶å†…çš„æ‰€æœ‰éŸ³é¢‘ï¼Œä»¥åŠå¯ä»¥æå–éŸ³é¢‘

    æœ‰äº›éŸ³ä¹å¬èµ·æ¥å¯èƒ½æ€ªæ€ªçš„ï¼Œ
    å¯ä»¥ç”¨éŸ³ä¹è½¬æ¢å·¥å…·å°†mp3è¿˜è½¬æ¢æˆmp3æ ¼å¼å°±å¯ä»¥æ­£å¸¸å¬äº†ã€‚
    æ¯”å¦‚åƒåƒé™å¬,foobar2000éƒ½å†…ç½®è½¬æ¢å™¨ï¼

#### Radio éƒ¨åˆ† å¯ç”¨åœ¨çº¿é¢„è§ˆ

[ç™¾åº¦ç½‘ç›˜ -&gt; è§£ç æµ‹è¯• &gt;éŸ³ä¹è§£ç æµ‹è¯• &gt;](https://pan.baidu.com/s/1MkWH6L6bsx3PJQWJuslwKw?pwd=fcfc)

---

## ğŸ–¼ï¸ DDS é¢„è§ˆ

~~#### [Texture Tools Exporter | NVIDIA Developer](https://developer.nvidia.com/texture-tools-exporter)~~

#### [TacentView]([Tools/DDSView.html](https://github.com/bluescan/tacentview))

Git del repositorio original 
https://e.coding.net/letleon/3d/Unpde.git
